<!doctype html><html class=no-js lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>Web Security Measures in ASP.NET Applications - Learnings in IT</title>
<script>(function(a,b){a[b]=a[b].replace("no-js","js")})(document.documentElement,"className")</script>
<meta name=description content>
<meta property="og:title" content="Web Security Measures in ASP.NET Applications">
<meta property="og:description" content="At my current workplace, All Applications are expected to adhere to PCI DSS standards meant for Data protection, Access Regulation and so on. Dedicated SOC Team,consisting of Security analyst who are continously on the prawl to identify breach, conduct periodic auditing of Applications, hardening of Servers.
While all our .NET applications adhere to below guidelines,
 ASP.NET Security Overview Secure Coding Guidelines Security Guidelines by OWASP  We also use tools like Snyk to perform code vulnerability analysis as part of Jenkins driven CI/CD pipeline.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://sachinsu.github.io/posts/websecurity/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2020-06-04T10:25:04+05:30">
<meta property="article:modified_time" content="2020-06-04T10:25:04+05:30">
<meta itemprop=name content="Web Security Measures in ASP.NET Applications">
<meta itemprop=description content="At my current workplace, All Applications are expected to adhere to PCI DSS standards meant for Data protection, Access Regulation and so on. Dedicated SOC Team,consisting of Security analyst who are continously on the prawl to identify breach, conduct periodic auditing of Applications, hardening of Servers.
While all our .NET applications adhere to below guidelines,
 ASP.NET Security Overview Secure Coding Guidelines Security Guidelines by OWASP  We also use tools like Snyk to perform code vulnerability analysis as part of Jenkins driven CI/CD pipeline."><meta itemprop=datePublished content="2020-06-04T10:25:04+05:30">
<meta itemprop=dateModified content="2020-06-04T10:25:04+05:30">
<meta itemprop=wordCount content="664">
<meta itemprop=keywords content>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Web Security Measures in ASP.NET Applications">
<meta name=twitter:description content="At my current workplace, All Applications are expected to adhere to PCI DSS standards meant for Data protection, Access Regulation and so on. Dedicated SOC Team,consisting of Security analyst who are continously on the prawl to identify breach, conduct periodic auditing of Applications, hardening of Servers.
While all our .NET applications adhere to below guidelines,
 ASP.NET Security Overview Secure Coding Guidelines Security Guidelines by OWASP  We also use tools like Snyk to perform code vulnerability analysis as part of Jenkins driven CI/CD pipeline.">
<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
<link rel=dns-prefetch href=//fonts.googleapis.com>
<link rel=dns-prefetch href=//fonts.gstatic.com>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
<link rel=stylesheet href=/css/style.css>
<link rel="shortcut icon" href=/favicon.ico>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-169012216-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body class=body>
<div class="container container--outer">
<header class=header>
<div class="container header__container">
<div class=logo>
<a class=logo__link href=/ title="Learnings in IT" rel=home>
<div class="logo__item logo__text">
<div class=logo__title>Learnings in IT</div>
<div class=logo__tagline>A Simple Technical Blog</div>
</div>
</a>
</div>
<nav class=menu>
<button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span>
</button>
<ul class=menu__list>
<li class=menu__item>
<a class=menu__link href=/about/>
<span class=menu__text>About</span>
</a>
</li>
<li class=menu__item>
<a class=menu__link href=/posts/>
<span class=menu__text>Blog</span>
</a>
</li>
<li class=menu__item>
<a class=menu__link href=/projects/>
<span class=menu__text>Projects</span>
</a>
</li>
<li class=menu__item>
<a class=menu__link href=https://gist.github.com/sachinsu>
<span class=menu__text>Gists</span>
</a>
</li>
<li class=menu__item>
<a class=menu__link href=/links/home>
<span class=menu__text>Useful Links</span>
</a>
</li>
</ul>
</nav>
</div>
</header>
<div class="wrapper flex">
<div class=primary>
<main class=main role=main>
<article class=post>
<header class=post__header>
<h1 class=post__title>Web Security Measures in ASP.NET Applications</h1>
<div class="post__meta meta"><div class="meta__item-author meta__item">
<svg class="meta__icon icon icon-author" width="16" height="16" viewBox="0 0 12 16"><path d="M6 1c2.2.0 3.5 2 3.5 4.5C9.5 7 8.9 8.2 8 9c2.9.8 4 2.5 4 5v1H0v-1c0-2.5 1.1-4.2 4-5-.9-.8-1.5-2-1.5-3.5C2.5 3 3.8 1 6 1z"/></svg><span class=meta__text>Sachin Sunkle</span>
</div>
<div class="meta__item-datetime meta__item">
<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2020-06-04T10:25:04+05:30>Jun 4 2020</time></div></div>
</header>
<div class="post__toc toc">
<div class=toc__title>Page content</div>
<div class=toc__menu>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#cookie-path>Cookie Path</a></li>
<li><a href=#samesite-cookie>SameSite Cookie</a></li>
<li><a href=#masking-of-sensitive-data>Masking of Sensitive Data</a></li>
</ul>
</li>
<li><a href=#summary>Summary</a></li>
</ul>
</nav>
</div>
</div><div class="content post__content clearfix">
<p>At my current workplace, All Applications are expected to adhere to <a href=https://en.wikipedia.org/wiki/Payment_Card_Industry_Data_Security_Standard target=_blank rel="noopener noreferrer">PCI DSS standards</a> meant for Data protection, Access Regulation and so on. Dedicated <a href=https://en.wikipedia.org/wiki/Information_security_operations_center target=_blank rel="noopener noreferrer">SOC</a> Team,consisting of Security analyst who are continously on the prawl to identify breach, conduct periodic auditing of Applications, hardening of Servers.</p>
<p>While all our .NET applications adhere to below guidelines,</p>
<ul>
<li><a href=https://support.microsoft.com/en-in/help/891028/asp-net-security-overview target=_blank rel="noopener noreferrer">ASP.NET Security Overview</a></li>
<li><a href=https://docs.microsoft.com/en-us/dotnet/standard/security/secure-coding-guidelines target=_blank rel="noopener noreferrer">Secure Coding Guidelines</a></li>
<li><a href=https://cheatsheetseries.owasp.org/cheatsheets/DotNet_Security_Cheat_Sheet.html target=_blank rel="noopener noreferrer">Security Guidelines by OWASP</a></li>
</ul>
<p>We also use tools like <a href=https://www.snyk.io/ target=_blank rel="noopener noreferrer">Snyk</a> to perform code vulnerability analysis as part of Jenkins driven CI/CD pipeline. In spite of above, we do come across vulnerabilities identified by SOC Team which we needs to be addressed quickly. SOC team uses tools such as <a href=https://portswigger.net/burp target=_blank rel="noopener noreferrer">Burp Suite</a>.</p>
<p>This post is going to summarize such incidents reported so far (and will keep updating it). In most of these cases, These issues required additional efforts over and above those provided by library or framework. Hopefully, it will be helpful to anyone trying address such vulnerabilities.</p>
<h3 id=cookie-path>Cookie Path</h3>
<p>Every cookie being sent by the Web application has attributes like,</p>
<ul>
<li>HTTPOnly - Indicates whether a cookie is accessible by client-side script</li>
<li>Domain - Indicates the domain to associate the cookie with</li>
<li>Path - the virtual path to transmit with the current cookie</li>
<li>Secure - Indicates whether cookie is sent only on Secure (HTTPS) Connections.</li>
</ul>
<p>OWASP has nice primer on <a href=https://owasp.org/www-chapter-london/assets/slides/OWASPLondon20171130_Cookie_Security_Myths_Misconceptions_David_Johansson.pdf target=_blank rel="noopener noreferrer">Cookie Security</a>.</p>
<p>Of the above, <strong>Path</strong> attribute limits the scope of a cookie to a specific path on the server and can therefore be used to prevent unauthorized access to it from other applications on the same host. Accordingly, SOC Team had recommended that all cookies issued by application must have path attribute set.</p>
<p>In case of typical ASP.NET Application, there are cookies generated by .NET framework (like for Session, Anti XSRF Token and son on) and custom ones which are issued and used by Application itself.</p>
<p>While it is fairly easy to set path for custom ones, we had to make code changes for cookies issued by .NET framework libraries. Lets take case of <a href=https://docs.microsoft.com/en-us/previous-versions/iis/6.0-sdk/ms525506%28v%3Dvs.90%29 target=_blank rel="noopener noreferrer">Session ID</a> cookie, by default, this cookie always has root <code>/</code> as path. So how can this be changed as per the application&rsquo;s deployment settings (i.e. specific virtual directory in IIS)?</p>
<p>We tried below,</p>
<ul>
<li>Step 1, try using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.httpcookiessection?view=netframework-4.8" target=_blank rel="noopener noreferrer">httpcookies</a> section in web.config like,</li>
</ul>
<pre><code>    &lt;httpCookies requireSSL=&quot;false&quot; httpOnlyCookies=&quot;true&quot;  domain=&quot;site.com/myapp&quot;/&gt;
</code></pre><p>First of all, this configuration element does not allow setting <strong>Path</strong> property and even during runtime, only the <strong>Domain</strong> property is populated while issuing the cookie. So this definitely does not help address the issue.</p>
<p>So other way is to programmatically set the path for Session Cookie. This can be done by providing custom implementation of SessionIDManager class like below,</p>
<pre><code>  public class MySessionIDManager : SessionIDManager, ISessionIDManager
    {
        void ISessionIDManager.SaveSessionID(HttpContext context, string id, out bool redirected, out bool cookieAdded)
        {
            base.SaveSessionID(context, id, out redirected, out cookieAdded);

            if (cookieAdded)
            {
                var name = &quot;ASP.NET_SessionId&quot;;
                var cookie = context.Response.Cookies[name];
                // this will be possibly read from configuration
                cookie.Path = &quot;/myapp&quot;; 
           }
        }
    }

</code></pre><p>Thanks to <a href=https://stackoverflow.com/questions/2326521/asp-net-session-cookies-specifying-the-base-domain target=_blank rel="noopener noreferrer">this</a> Stackoverflow thread for listing this approach. Application under consideration only had this particular cookie however, for all other .NET framework issued cookies, similar technique will have to be used.</p>
<h3 id=samesite-cookie>SameSite Cookie</h3>
<p>This is already detailed <a href=/posts/samesitecookies>here</a></p>
<h3 id=masking-of-sensitive-data>Masking of Sensitive Data</h3>
<p>This typically involves masking the sensitive data like</p>
<ul>
<li>E-mail id</li>
<li>Phone Number</li>
<li>Credit/Debit Card Number</li>
</ul>
<p>It could well be used in Web Application or be received or sent as part of HTTP API.</p>
<p>The best bet in this case is to mask it on the server side itself before sending/rendering the data in browser. Note that, in some cases, above fields are used for data binding purposes. The approach we followed in such scenario was to use Hash value of it instead of merely masking the data. We have always used <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.sha256?view=netcore-3.1" target=_blank rel="noopener noreferrer">SHA256</a> or above for hashing.</p>
<h2 id=summary>Summary</h2>
<p>Addressing security vulnerabilities is continuous process as hackers keep on inventing new ways for breaching and exploiting weak spots. As Application Architect/Developers, we need to brace ourselves for the same.</p>
<p>Happy Coding !!</p>
<hr>
<script src=https://utteranc.es/client.js repo=sachinsu/sachinsu.github.io issue-term=title label=blogcomment theme=github-light crossorigin=anonymous async></script>
</div>
</article>
</main>
<div class="authorbox clearfix">
<div class=authorbox__header>
<span class=authorbox__name>About Sachin Sunkle</span>
</div>
<div class=authorbox__description>
A Coder in IT
</div>
</div>
<nav class="pager flex">
<div class="pager__item pager__item--prev">
<a class=pager__link href=/posts/webassembly/ rel=prev>
<span class=pager__subtitle>«&#8201;Previous</span>
<p class=pager__title>Is WebAssembly future of Web Development</p>
</a>
</div>
<div class="pager__item pager__item--next">
<a class=pager__link href=/posts/massdmgolang/ rel=next>
<span class=pager__subtitle>Next&#8201;»</span>
<p class=pager__title>Tool to mass DM followers on Twitter in Go</p>
</a>
</div>
</nav>
</div>
</div>
<footer class=footer>
<div class="container footer__container flex">
<div class=footer__copyright>
&copy; 2021 Sachin Sunkle.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span>
</div>
</div>
</footer>
</div>
<script async defer src=/js/menu.js></script>
</body>
</html>