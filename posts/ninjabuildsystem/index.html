<!doctype html><html class=no-js lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Ninja - Using lightweight build system for Go projects - Learnings in IT</title>
<script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:url" content="https://sachinsu.github.io/posts/ninjabuildsystem/"><meta property="og:site_name" content="Learnings in IT"><meta property="og:title" content="Ninja - Using lightweight build system for Go projects "><meta property="og:description" content="Background I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.
Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn’t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems)."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-27T10:25:04+05:30"><meta property="article:modified_time" content="2020-10-27T10:25:04+05:30"><meta property="article:tag" content="Go"><meta property="article:tag" content="Golang"><meta property="article:tag" content="Ninja"><meta property="article:tag" content="Make"><meta property="article:tag" content="Cmake"><meta itemprop=name content="Ninja - Using lightweight build system for Go projects "><meta itemprop=description content="Background I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.
Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn’t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems)."><meta itemprop=datePublished content="2020-10-27T10:25:04+05:30"><meta itemprop=dateModified content="2020-10-27T10:25:04+05:30"><meta itemprop=wordCount content="495"><meta itemprop=keywords content="Go,Golang,Ninja,Make,Cmake"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ninja - Using lightweight build system for Go projects "><meta name=twitter:description content="Background I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.
Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn’t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems)."><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css><link rel="shortcut icon" href=/favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title="Learnings in IT" rel=home><div class="logo__item logo__text"><div class=logo__title>Learnings in IT</div><div class=logo__tagline>A Simple Technical Blog</div></div></a></div><nav class=menu><button class=menu__btn aria-haspopup=true aria-expanded=false tabindex=0>
<span class=menu__btn-title tabindex=-1>Menu</span></button><ul class=menu__list><li class=menu__item><a class=menu__link href=/about/><span class=menu__text>About</span></a></li><li class=menu__item><a class=menu__link href=/posts/><span class=menu__text>Blog</span></a></li><li class=menu__item><a class=menu__link href=/projects/><span class=menu__text>Projects</span></a></li><li class=menu__item><a class=menu__link href=https://gist.github.com/sachinsu><span class=menu__text>Gists</span></a></li><li class=menu__item><a class=menu__link href=/links/home><span class=menu__text>Useful Links</span></a></li></ul></nav></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>Ninja - Using lightweight build system for Go projects</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0a14 14 0 110 28 1 1 0 010-28m0 3a3 3 0 100 22 3 3 0 000-22m1 4h-2v8.4l6.8 4.4L22 18l-6-3.8z"/></svg><time class=meta__text datetime=2020-10-27T10:25:04+05:30>Oct 27 2020</time></div></div></header><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><a href=#background>Background</a></li></ul></nav></div></div><div class="content post__content clearfix"><h2 id=background>Background</h2><p>I primarily work on Windows for development purposes. Whenever its about writing code in Golang, invariably one comes across usage of Make. A quick check on popular Go projects on Github will show Makefile being used to automate tasks like linting, build, testing and deployment.</p><p>Being on Windows, i have been looking for alternative build tool that is easy to setup (i.e. doesn&rsquo;t require mingw and such environments) and use compared to Make (which is primarily targetted at Unix and Unix like Operating Systems).</p><p>Following a wonderful post by Julia Evans (read <a href=https://jvns.ca/blog/2020/10/26/ninja--a-simple-way-to-do-builds/ target=_blank rel="noopener noreferrer">here</a>) on <a href=https://ninja-build.org target=_blank rel="noopener noreferrer">Ninja</a>. I decided to give it a try for a Golang Application.</p><p>Julia, in her post, has covered important aspects of Ninja but to summarize, Ninja is,</p><ul><li>A build automation tool</li><li>Lightweight, with focus on speed</li><li>Easy to configure</li><li>Cross platform (Easy to setup across Windows and Linux)</li></ul><p>With this, lets give it a try,</p><p>To start with, lets create a simple go &lsquo;Hello World&rsquo; project,</p><ul><li><p>Initiate Go Module (in a Empty folder), <code>go mod init github.com/sachinsu/ninjabuild</code></p></li><li><p>Create a &lsquo;main.go&rsquo; that prints &lsquo;Hello World&rsquo;,</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span>        <span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;hello world&#34;</span>)
</span></span><span style=display:flex><span>        }
</span></span></code></pre></div><ul><li><p>Now setup Ninja, It is as easy as downloading binary for your Platform. It is also possible to build it locally, if you prefer it that way. For details, refer <a href=https://ninja-build.org/ target=_blank rel="noopener noreferrer">here</a></p></li><li><p>Once ninja is setup, lets create build configuration file (i.e. build.ninja),</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-YAML data-lang=YAML><span style=display:flex><span><span style=color:#ae81ff>GOARCH = amd64</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>GOOS = linux</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>rule lint</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>command = go vet -mod=vendor ./...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>build lintoutput</span>: <span style=color:#ae81ff>lint </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>rule unit</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>command = go test -mod=vendor -cover -v -short ./...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>build utest</span>: <span style=color:#ae81ff>unit </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>rule compile</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>command = cmd /c go mod tidy &amp;&amp; go mod vendor &amp;&amp;  go build -o $out $in  &amp;&amp; echo &#34;build done.&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>description = compile $in</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>build ninjabuild.exe</span>: <span style=color:#ae81ff>compile .</span>
</span></span></code></pre></div><p>lets go through the contents of this file,</p><ul><li><p>One can define variables <code>GOARCH = amd64</code> and refer them as <code>$GOARCH</code></p></li><li><p>Ninja configuration is combination of build step and associated rule, for e.g.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-YAML data-lang=YAML><span style=display:flex><span><span style=color:#ae81ff>rule compile</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>command = cmd /c go mod tidy &amp;&amp; go mod vendor &amp;&amp;  go build -o $out $in  &amp;&amp; echo &#34;build done.&#34;</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>description = compile $in</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>build ninjabuild.exe</span>: <span style=color:#ae81ff>compile .</span>
</span></span></code></pre></div><ul><li>Above snippet, defines rule <code>compile</code> with associated command that builds the code. Being on Windows, i have used <code>cmd /c</code> to start a new shell and concatenate multiple commands as part of <code>compile </code>rule using <code>&&</code> which chains the commands and executes next one only if current one succeeds.</li></ul><p>As demonstrated in above file, Ninja can be used to automate wide variety of tasks like build, tests, deployment and so on.</p><p>Many of you using Make will find the approach similar to it. In contrast to Make, Ninja lacks features such as string manipulation, as Ninja build files are not meant to be written by hand. Instead, a &ldquo;build generator&rdquo; should be used to generate Ninja build files.</p><p>I found simplicity (of installation and configuration) and easy of use to be key aspects of this tool.</p><p>Happy Coding !!</p><hr><script src=https://utteranc.es/client.js repo=sachinsu/sachinsu.github.io issue-term=title label=blogcomment theme=github-light crossorigin=anonymous async></script></div><footer class=post__footer><div class="post__tags tags clearfix"><svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M4 0h8s2 0 4 2l15 15s2 2 0 4L21 31s-2 2-4 0L2 16s-2-2-2-4V3s0-3 4-3m3 10a3 3 0 000-6 3 3 0 000 6"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/tags/go/ rel=tag>go</a></li><li class=tags__item><a class="tags__link btn" href=/tags/golang/ rel=tag>golang</a></li><li class=tags__item><a class="tags__link btn" href=/tags/ninja/ rel=tag>ninja</a></li><li class=tags__item><a class="tags__link btn" href=/tags/make/ rel=tag>make</a></li><li class=tags__item><a class="tags__link btn" href=/tags/cmake/ rel=tag>cmake</a></li></ul></div></footer></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/posts/urlhealthchecks/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>Validating urls from 'Useful Links' section using bash / command line tools</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/posts/opentelemetry/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>Getting Started with OpenTelemetry</p></a></div></nav></div></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2024 Sachin Sunkle.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=/js/menu.js></script></body></html>