<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Presto - A distributed SQL Engine for variety of data stores | Learnings in IT</title>
<meta name="keywords" content="Presto, SQL, Database, Parquet, Analytics, Trino">
<meta name="description" content="Introduction
In a company/enterprise, typically there are multiple sources of data. This could be result of M&amp;A (where each of those add in a new data store) or result of multi year process of using data stores that are in vogue at that time. Result is combination of various types of relational databases, flat file systems, queues and so on. This results in Data Silos. This scenario is typically observed in companies who are running workloads On-prem (i.e. Pre-cloud, Companies who started on Cloud or have moved to it, typically tend to organize data platform better. This could be because of ease of migrating data on cloud. Typically, they centralize it around cheaper object storage (say AWS S3)).">
<meta name="author" content="map[name:Sachin Sunkle]">
<link rel="canonical" href="http://localhost:1313/posts/presto/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/presto/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Learnings in IT (Alt + H)">Learnings in IT</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://gist.github.com/sachinsu" title="Gists">
                    <span>Gists</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/links/home" title="Useful Links">
                    <span>Useful Links</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Presto - A distributed SQL Engine for variety of data stores
    </h1>
    <div class="post-meta"><span title='2021-03-29 10:25:04 +0530 IST'>Mar 29 2021</span>&nbsp;·&nbsp;map[name:Sachin Sunkle]

</div>
  </header> 
  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>In a company/enterprise, typically there are multiple sources of data. This could be result of M&amp;A (where each of those add in a new data store) or result of multi year process of using data stores that are in vogue at that time. Result is combination of various types of relational databases, flat file systems, queues and so on. This results in Data Silos. This scenario is typically observed in companies who are running workloads On-prem (i.e. Pre-cloud, Companies who started on Cloud or have moved to it, typically tend to organize data platform better. This could be because of ease of migrating data on cloud. Typically, they centralize it around cheaper object storage (say AWS S3)).</p>
<p>Company will want to utilize this data, accumulated over the years, for business intelligence, machine learning purposes. Usually, it would require querying efficiently across these data sources or first collecting all the data in central location (say Data Lake or Operational Data store) and then querying on it.</p>
<p>Overall, below are the widely adopted approaches,</p>
<ul>
<li>
<p><strong>Data warehouse with ETL Approach</strong> - This involves extracting data from Transactional systems (OLTP), ERP, Events store and so on. Transforming the same and then loading it into Data warehouse which is typically a store used for Analytics. Whole process is orchestrated as workflow using ETL Tools.</p>
</li>
<li>
<p><strong>Lakehouse</strong> - Many companies have two different types of storate: Data Lake and Data warehouse. The data warehouse handles <code>offline</code> analytics, such as BI dashboards and reports, that describe what has or is happening in a business.  The data lake is store for raw data (including unstructured). Instead of ETL (Extract - Transform - Load), ELT (Extract - Load - Transform) approach is followed where data from transactional system is loaded into Data Lake. Later, it is transformed/processed for analytics purposes and loaded in data warehouse. Alternatively, there is a trend where data lake itself is used for trend and/or predictive analytics. Data lake is usually based on cheaper, object storage with data stored using open formats (like Parquet , ORC etc.) favouring columnar approach. Columnar store is typically favoured for analytics over relational one.</p>
</li>
</ul>
<p>As explained in <a href=https://a16z.com/2020/10/15/the-emerging-architectures-for-modern-data-infrastructure/
    
    target=_blank rel="noopener noreferrer"
>Emerging Architecture for Data Infrastructure</a>,</p>
<ul>
<li>Data warehouse is used for analytics use cases i.e. help business make better decisions.</li>
<li>Data lake is used for operational use cases.</li>
</ul>
<p>All the above approaches typically assume rather large volume of data being handled. Then what can be approach for companies who are having moderate amount of data (few terabytes) and still want to derive actionable insights from it. Such companies are unlikely to have big data systems like HDFC in place.</p>
<p>For these cases, One may consider <a href=https://prestodb.io/
    
    target=_blank rel="noopener noreferrer"
>Presto</a> a.k.a. <a href=https://trino.io
    
    target=_blank rel="noopener noreferrer"
>Trino</a>. At it&rsquo;s core, Presto translates SQL queries (it supports <strong>ANSI SQL</strong>) into whatever query language is necessary to access the underlying storage medium. Storage medium could be a Elasticsearch cluster, or a set of Parquet files on HDFS, or a relational database.</p>
<p>Presto uses <em>MPP</em> (Massively parallel processing) architecture in which it has,</p>
<ul>
<li><code>Coordinator</code> node - responsible for creating query plan and distributing the work among workers.</li>
<li><code>Worker</code> node(s) - they push down predicates to those data sources. Only the data necessary to compute join is retrieved. All workers operate in parallel mode.</li>
</ul>
<p>Presto provides many <a href=https://trino.io/docs/current/connector.html
    
    target=_blank rel="noopener noreferrer"
>connectors</a> like below (but not limited to),</p>
<ul>
<li><em>Relational Databases</em>
<ul>
<li>MySQL</li>
<li>PostGres</li>
<li>SQL Server</li>
</ul>
</li>
<li><em>Non-relational Databases</em>
<ul>
<li>Mongodb</li>
<li>Redis</li>
<li>Cassandra</li>
</ul>
</li>
<li><em>Columnar file formats like ORC, Parquet and Avro – stored on:</em>
<ul>
<li>Amazon S3</li>
<li>Google Cloud Store</li>
<li>Azure Blog Store</li>
<li>HDFS</li>
<li>Clustered file systems</li>
</ul>
</li>
</ul>
<p>It&rsquo;s important to note that Presto does not write intermidiate results to disk, Hence worker nodes are expected to be optimized for processing and memory  over storage. A Single Presto query can combine data from multiple sources. Most importantly, Presto can work without Hadoop. Presto has cost-based optimizer which means query plan takes into account the time cost associated with executing that plan and can therefore do various types of optimizations around join ordering and the sequence with which you execute that query plan to deliver the fastest level of performance.</p>
<p>Below is apt representation of how Presto works (Ref: <a href=https://prestodb.io
    
    target=_blank rel="noopener noreferrer"
>prestodb.io</a>)</p>
<figure>
    <img loading="lazy" src="https://prestodb.io/img/presto-overview-2.png"/> <figcaption>
            Where Presto fits
        </figcaption>
</figure>

<figure>
    <img loading="lazy" src="https://prestodb.io/img/presto-architecture.png"/> <figcaption>
            Typical Presto Deployment
        </figcaption>
</figure>

<p>Typical use cases for Presto are,</p>
<ul>
<li>Ad-hoc, Interactive Analytics</li>
<li>Batch ETL processing.</li>
<li>Centralized Data Access with Query Federation</li>
</ul>
<p>From the consumption perspective, Presto Offers CLI as well as JDBC Driver. However, there are many <a href=https://trino.io/resources.html
    
    target=_blank rel="noopener noreferrer"
>language specific clients</a> available from Community.</p>
<p>Key points to note while considering Presto,</p>
<ul>
<li>No need for complex ETL/ELT processes and related Monitoring.</li>
<li>No need to provision for  specialized data store for Data Lake and/or Data warehouse.
<ul>
<li><em>However, this may not hold true if Query results from Presto are required to persisted. Although, overall efforts and cost will much lower.</em></li>
<li><em>This would also mean that existing data stores need to maintain historical data too</em></li>
</ul>
</li>
<li>Any specific use cases not suitable for Presto will have to be alternatively approached.</li>
</ul>
<p>Some of the points to explore further would be ,</p>
<ul>
<li>Given that Presto does not use storage on its own, how can one perform Capacity planning given the expected workflow ?</li>
<li>How are failures handled?</li>
</ul>
<h3 id="useful-referencesinteresting-links">Useful References/Interesting Links,<a hidden class="anchor" aria-hidden="true" href="#useful-referencesinteresting-links">#</a></h3>
<ul>
<li><a href=https://trino.io
    
    target=_blank rel="noopener noreferrer"
>Trino</a></li>
<li><a href=https://github.com/treasure-data/prestogres/
    
    target=_blank rel="noopener noreferrer"
>PostgreSQL protocol gateway for Presto distributed SQL query engine</a></li>
</ul>
<p>Happy Coding !!</p>
<hr>
<script src="https://utteranc.es/client.js" repo="sachinsu/sachinsu.github.io" issue-term="title" label="blogcomment"
    theme="github-light" crossorigin="anonymous" async></script>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/presto/">Presto</a></li>
      <li><a href="http://localhost:1313/tags/sql/">SQL</a></li>
      <li><a href="http://localhost:1313/tags/database/">Database</a></li>
      <li><a href="http://localhost:1313/tags/parquet/">Parquet</a></li>
      <li><a href="http://localhost:1313/tags/analytics/">Analytics</a></li>
      <li><a href="http://localhost:1313/tags/trino/">Trino</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Learnings in IT</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
